# Бот для продажи пиццы

Бот реализован для двух социальных сетей:
- [Telegram](https://web.telegram.org/)
- [Facebook](https://www.facebook.com/)

Бот позволяет автоматизировать процесс продажи пиццы. В боте интегрирована API [Elasticpath](https://euwest.cm.elasticpath.com/).

### Возможности Telegram бота:

- Просмотр списка товаров с пагинацией;
- Подробный просмотр товара с его описанием и ценой;
- Добавление товара в корзину;
- Удаление товара из корзины;
- Выбор способа доставки в зависимости от адреса доставки:
  - Самовывоз;
  - Доставка курьером:
    - Отправка уведомления курьеру с геолокацией адреса доставки;
    - Запуск отложенного уведомления через час после заказа;
- Оплата заказа картой;

### Возможности Facebook бота:

- Просмотр списка товаров по категориям;
- Подробный просмотр товара с его описанием и ценой;
- Добавление товара в корзину;
- Удаление товара из корзины;
- Увеличение количества товаров через корзину;

## Как запустить

- Скачайте код:
```shell
$ git clone https://github.com/Alex-Men-VL/sell_pizza.git
$ cd sell_pizza
```
- Установите зависимости:
```shell
$ pip install -r requirements.txt
```
- Запустите Telegram бота:
```shell
$ python3 tg_bot.py
```
- Запустите Facebook бота:
```shell
$ python3 facebook_webhook.py
```

## Переменные окружения

Часть данных берется из переменных окружения. Чтобы их определить, создайте файл `.env` в корне проекта и запишите 
туда данные в таком формате: `ПЕРЕМЕННАЯ=значение`

**Общие настройки:**

- `YANDEX_API_KEY` - API ключ Яндекс-геокодера. [Как получить](https://developer.tech.yandex.ru/services/).
- Настройки для [ElasticPath](https://euwest.cm.elasticpath.com/):
  - `CLIENT_ID` - id клиента;
  - `CLIENT_SECRET` - секретный ключ клиента;

**Настройки для Telegram бота:**

- `TG_BOT_TOKEN` - токен телеграм бота. Чтобы его получить, напишите в Telegram специальному боту: BotFather;
- `TG_DEV_CHAT_ID` - id пользователя в телеграм, кому будут приходить сообщения с ошибками;
- `TELEGRAM_DEV_BOT_TOKEN` - токен телеграм бота, который будет присылать сообщения с логами пользователю, id которого 
  указан в переменной `TG_DEV_CHAT_ID`;
- `PAYMENT_PROVIDER_TOKEN` - токен провайдера платежей. 
[Как получить](https://yookassa.ru/docs/support/payments/onboarding/integration/cms-module/telegram) на примере `ЮKassa`.

**Настройки для Facebook бота:**

- `PAGE_ACCESS_TOKEN` - токен для webhook;
- `VERIFY_TOKEN` - маркер, который Facebook вернет вам в рамках подтверждения URL обратного вызова;

*Подробнее смотри в туториале* [*как начать разработку ботов в Facebook*](https://gist.github.com/voron434/3765d14574067d17aa9e676145df360e).

- `REDIS_URL` - URL базы данных Redis;
- `REDIS_PORT` - порт базы данных Redis;
- `REDIS_PASSWORD` - пароль от базы данных Redis;


## Пример работы бота

![телеграм бот](.github/tg.gif)

## Цель проекта

Код написан в образовательных целях на онлайн-курсе для веб-разработчиков [dvmn.org](https://dvmn.org/).